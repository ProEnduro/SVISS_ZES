<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<ui:composition template="/pages/mainSite.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">


    <ui:define name="content">
        <h:form id="tableForm">
            <p:dataTable id="usertable" var="user" value="#{benutzerverwaltungsBean.userList}">

                <p:column headerText="Username">
                    <h:outputText value="#{user.username}"/>
                </p:column>

                <p:column headerText="Name">
                    <h:outputText value="#{user.persName}"/>
                </p:column>

                <p:column headerText="Berechtigungsstufe">
                    <h:outputText value="#{user.accessLevel}">
                        <f:converter converterId="accesslevelconv"/>
                    </h:outputText>
                </p:column>

                <p:column headerText="E-Mail-Adresse">
                    <h:outputText value="#{user.email}"/>
                </p:column>

                <p:column headerText="Enabled">
                    <h:outputText value="#{user.disabledString}"/>
                </p:column>

                <p:column headerText="User ändern">
                    <p:commandButton value="edit" action="#{benutzerverwaltungsBean.editUser(user)}" update=":dialogForm:dlgGrid" oncomplete="PF('udlg1').show();"/>
                </p:column>

            </p:dataTable>

            <p:commandButton id="testBut" update=":dialogForm:dlgGrid"  value="New User" action="#{benutzerverwaltungsBean.newUser}" oncomplete="PF('udlg1').show();"/>

        </h:form>

        <p:dialog  closeOnEscape="true" header="User Dialog" widgetVar="udlg1" modal="true">
            <h:form id="dialogForm">
                <p:panelGrid id="dlgGrid">
                    <p:row>
                        <p:column><p:outputLabel value="Accesslevel "/></p:column>
                        <p:column><p:selectOneMenu value="#{benutzerverwaltungsBean.selectedUser.accessLevel}">
                                <f:selectItems value="#{benutzerverwaltungsBean.accessGroups}" var="ag" itemLabel="#{ag.accessLevelName}" itemValue="#{ag}"/>
                                <f:converter converterId="accesslevelconv"/>
                            </p:selectOneMenu></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Username: "/></p:column>
                        <p:column><p:inputText value="#{benutzerverwaltungsBean.selectedUser.username}"/></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Password: "/></p:column>
                        <p:column><p:inputText type="password" value="#{benutzerverwaltungsBean.selectedUser.pass}" /></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Vorname Nachname: "/></p:column>
                        <p:column><p:inputText value="#{benutzerverwaltungsBean.selectedUser.persName}"/></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="E-Mail-Adresse: "/></p:column>
                        <p:column><p:inputText value="#{benutzerverwaltungsBean.selectedUser.email}"/></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Hiredate: "/></p:column>
                        <p:column><p:calendar value="#{benutzerverwaltungsBean.selectedUser.hiredate}" pattern="dd.MM.yyyy" mask="true"/></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Worktime: "/></p:column>
                        <p:column><p:inputMask id="worktimeIn"  mask="99.9" value="#{benutzerverwaltungsBean.selectedUser.weekTime}"/></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Vacation Left: "/></p:column>
                        <p:column><p:inputText type="number" value="#{benutzerverwaltungsBean.selectedUser.vacationLeft}" /></p:column>
                    </p:row>

                    <p:row>
                        <p:column><p:outputLabel value="Overtime Left: "/></p:column>
                        <p:column><p:inputText type="number" value="#{benutzerverwaltungsBean.selectedUser.overTimeLeft}" /></p:column>
                    </p:row>

                    <p:row>
                        <p:column colspan="2"><p:selectBooleanButton value="#{benutzerverwaltungsBean.selectedUser.disabled}"  onLabel="Disabled" offLabel="Enabled"/></p:column>
                    </p:row>

                    <f:facet name="footer">
                        <p:row>
                            <p:column><p:commandButton value="User speichern" action="#{benutzerverwaltungsBean.saveUser}" update=":tableForm:usertable" oncomplete="PF('udlg1').hide();"/></p:column>
                            <p:column><p:commandButton value="Änderung verwerfen" action="#{benutzerverwaltungsBean.discardUserChanges}" oncomplete="PF('udlg1').hide();"/></p:column>
                        </p:row>
                    </f:facet>
                </p:panelGrid>
            </h:form>
        </p:dialog>   

    </ui:define>
</ui:composition>
